<?php 	$title = "Web - Create Page";		$css = "	<link rel='stylesheet' type='text/css' href='css/index.css'>";		$js = "	<script type='text/javascript' src='js/index.js'></script>";		require($_SERVER['DOCUMENT_ROOT']."/manager/header.php");	?><div id='main'>		<h1>Creating a Web Page</h1>		<?php 		$rPath = $_SERVER['REQUEST_URI'];		if ($_POST) {				$type = $_POST["page-type"];		$name = $_POST["page-name"];		$path = $_POST["path"];		$title = $_POST["title"];		$description = $_POST["description"];		$keywords = $_POST["keywords"];				// make sure we have a page name, if not default to index		if (!isset($name) || trim($name) === "") {						$name = "index";			$type = "index";		}				// make sure the path starts and ends with a '/'		$pathlen = strlen($path);		$start = substr($path, 0, 1);		$end = substr($path, $pathlen-1, 1);				if ($start !== "/") $path = "/".$path;				if ($end !== "/") $path = $path."/";				// make sure the user is not trying to delete the web page maker		if ($rPath."index.php" !== $path.$name.".php") {						// create initial directory			createDir($_SERVER["DOCUMENT_ROOT"].$path);						// if file does not exist create it, else throw error			if (!file_exists($path.$name.".php")) {								// if we are creating a home page, it needs css and a js file				if ($type === "index") {										// these can only be files relative to the folder the index.php is in					$file_list = array(						$name.".php" => "<?php \r\r?>",						"js/index.js" => "$(document).ready(function () {\r\r});",						"css/index.css" => ""					);										foreach ($file_list as $file => $filetxt) {												// if there is a folder in the file path						if (strpos($file, "/") !== false) {														// get the folder path							$exFile = explode("/", $file);							array_pop($exFile);							$folder = implode("/", $exFile);														// check to make sure the folder is already created							createDir($_SERVER["DOCUMENT_ROOT"].$path.$folder);						}												$result = fopen($_SERVER["DOCUMENT_ROOT"].$path.$file, "w");												// if the file was create successfully						if ($result) {														echo "<div>Successfully created file [".$_SERVER["DOCUMENT_ROOT"].$path.$file."]</div>";														// write to the file							fwrite($result, $filetxt);														fclose($result);						}						else echo "<div class='ui-state-error'>Failed to create file [".$_SERVER["DOCUMENT_ROOT"].$path.$file."]</div>";					}				}				else {										$result = fopen($_SERVER["DOCUMENT_ROOT"].$path.$name.".php", "w");									if ($result) echo "<div>Successfully created file [".$_SERVER["DOCUMENT_ROOT"].$path.$name.".php]</div>";					else echo "<div class='ui-state-error'>Failed to create file [".$_SERVER["DOCUMENT_ROOT"].$path.$name.".php]</div>";				}			}		}		else echo "<div class='ui-state-error'>You cannot overwrite the web page creator index page, that would be madness!</div>";	}	else {				// if we are on an index.php dont display the file name		if (strpos($rPath, ".") !== false) {						$exrPath = explode("/", $rPath);			$countPath = count($exrPath);						array_pop($exrPath);			$rPath = implode("/", $exrPath)."/";		}			?>	<form method="POST" action="">			<div>			<label for="page-type">Type of Page</label>			<select name="page-type" id="page-type">				<option value="index">Home/Index</option>				<option value="form-landing-page">Form Landing Page</option>				<option value="other">Other</option>			</select>		</div>			<div>			<label for="page-name">Page Name</label>			<input type="text" name="page-name" id="page-name"/>		</div>				<div>			<label for="path">Path</label>			<input type="text" name="path" id="path" value="<?php echo $rPath; ?>"/>		</div>				<div>			<label for="title">Title</label>			<input type="text" name="title" id="title"/>		</div>				<div>			<label for="description">Description</label>			<textarea name="description" id="description" rows="5"></textarea>		</div>				<div>			<label for="keywords">Keywords</label>			<input name="keywords" id="keywords" />		</div>				<div class='submit-container'>			<button type='submit' id="submit">Submit Form</button>		</div>	</form>	<?php 	}		function createDir ($path) {				// if the path does not exist create it		if (!file_exists($path)) {						$result = mkdir($path);						if ($result) echo "<div>Successfully created directory [".$path."]</div>";			else echo "<div class='ui-state-error'>Failed to create directory [".$path."]</div>";						return $result;		}		else return false;	}	?></div>