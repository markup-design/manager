<?php 	$title = "Web - Create Page";		$css = "	<link rel='stylesheet' type='text/css' href='css/index.css'>";		$js = "	<script type='text/javascript' src='js/index.js'></script>";		require($_SERVER['DOCUMENT_ROOT']."/manager/header.php");	?><div id='main'>		<h1>Creating a Web Page</h1>		<?php 		$rPath = $_SERVER['REQUEST_URI'];		if ($_POST) {				$type = $_POST["page-type"];		$name = $_POST["page-name"];		$path = $_POST["path"];		$title = $_POST["title"];		$description = $_POST["description"];		$keywords = $_POST["keywords"];				$webpage = new WebPage($path, $name);		$webpage->setHeader("Title", $title);		$webpage->setHeader("Description", $description);		$webpage->setHeader("Keywords", $keywords);		$webpage->setHeader("Links", array("./css/index.css"));		$webpage->setHeader("JS", array("./js/index.js"));		$webpage->includeFile("/manager/header.php");		$webpage->includeFile("/manager/footer.php");				// make sure we have a page name, if not default to index		if (!isset($name) || trim($name) === "") {						$name = "index";			$type = "index";		}				// make sure the path starts and ends with a '/'		$pathlen = strlen($path);		$start = substr($path, 0, 1);		$end = substr($path, $pathlen-1, 1);		if ($start !== "/") $path = "/".$path;		if ($end !== "/") $path = $path."/";					// create initial directory		createDir($_SERVER["DOCUMENT_ROOT"].$path);					// different types of pages		switch ($type) {						case "index": // if we are creating a home page, it needs css and a js file							// make sure the user is not trying to delete the web page maker				if (stripos($path.$name.".php", $rPath."index.php") === false) {										// these can only be files relative to the folder the index.php is in					$file_list = array(						$name.".php",						"js/index.js",						"css/index.css"					);										foreach ($file_list as $filename) {												$webpage->createFile($filename);					}				}				else echo "<div class='ui-state-error'>You cannot overwrite the web page creator index page, that would be madness!</div>";							break;						case "form-landing-page":							// create file				$result = fopen($_SERVER["DOCUMENT_ROOT"].$path.$name.".flp.php", "w");				fwrite($result, "<?php \r\r?>");				fclose($result);								if ($result) echo "<div>Successfully created file [".$_SERVER["DOCUMENT_ROOT"].$path.$name.".flp.php]</div>";				else echo "<div class='ui-state-error'>Failed to create file [".$_SERVER["DOCUMENT_ROOT"].$path.$name.".php]</div>";			break;						default: // create php page							// make sure the user is not trying to delete the web page maker				if (stripos($path.$name.".php", $rPath."index.php") === false) {										// create file					$result = fopen($_SERVER["DOCUMENT_ROOT"].$path.$name.".php", "w");					fwrite($result, "<?php \r\r?>");					fclose($result);										if ($result) echo "<div>Successfully created file [".$_SERVER["DOCUMENT_ROOT"].$path.$name.".php]</div>";					else echo "<div class='ui-state-error'>Failed to create file [".$_SERVER["DOCUMENT_ROOT"].$path.$name.".php]</div>";				}				else echo "<div class='ui-state-error'>You cannot overwrite the web page creator index page, that would be madness!</div>";						break;		}	}	else {				// if we are on an index.php dont display the file name		if (strpos($rPath, ".") !== false) {						$exrPath = explode("/", $rPath);			$countPath = count($exrPath);						array_pop($exrPath);			$rPath = implode("/", $exrPath)."/";		}			?>	<!-- FORM FOR CREATING WEB PAGE -->	<!-- POSTS TO THIS PAGE -->	<form method="POST" action="">			<div class='form-row'>			<label for="page-type">Type of Page</label>			<select name="page-type" id="page-type">				<option value="index">Home/Index</option>				<option value="form-landing-page">Form Landing Page</option>				<option value="other">Other</option>			</select>		</div>			<div class='form-row'>			<label for="page-name">Page Name</label>			<input type="text" name="page-name" id="page-name" info='Give your page a name.'/>		</div>				<div class='form-row'>			<label for="path">Path</label>			<input type="text" name="path" id="path" value="<?php echo $rPath; ?>"/>			<button type='button' id='relative-path-button'></button>		</div>				<div class='form-row'>			<label for="title">Title</label>			<input type="text" name="title" id="title"/>		</div>				<div class='form-row'>			<label for="description">Description</label>			<textarea name="description" id="description" rows="5"></textarea>		</div>				<div class='form-row'>			<label for="keywords">Keywords</label>			<input name="keywords" id="keywords" />		</div>				<div class='form-row submit-container'>			<button type='submit' id="submit">Submit Form</button>		</div>	</form>	<?php 	}		function createDir ($path) {				// if the path does not exist create it		if (!file_exists($path)) {						$result = mkdir($path);						if ($result) echo "<div>Successfully created directory [".$path."]</div>";			else echo "<div class='ui-state-error'>Failed to create directory [".$path."]</div>";						return $result;		}		else return false;	}	?></div>